<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>XMLHTTPRequest</title>
<script type="text/javascript">
    var xmlhttp;

    function loadXMLDoc(url) 
    {
        xmlhttp = null;
        if (window.XMLHttpRequest) 
        {
            // code for Firefox, Mozilla, IE7, etc.        
            xmlhttp = new XMLHttpRequest();
        }
        else if (window.ActiveXObject) 
        {
            // code for IE6, IE5                
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        if (xmlhttp != null) 
        {
            xmlhttp.onreadystatechange = state_Change;
            xmlhttp.open("GET", url, true);
            xmlhttp.send(null);
        }
        else 
        {
            alert("Your browser does not support XMLHTTP.");
        } 
    }

function state_Change()
{
    if (xmlhttp.readyState == 4) 
    {
        // 4 = "loaded"
        if (xmlhttp.status == 200) 
        {
            // 200 = "OK"
            //alert(xmlhttp.responseText);
            
            //document.getElementById('p1').innerHTML = xmlhttp.getAllResponseHeaders();
            document.getElementById('p1').innerHTML = xmlhttp.getResponseHeader("connection");
        }
        else {
            alert("Problem retrieving data:" + xmlhttp.statusText);
        }
    }
}
//test_xmlhttp.txt
</script>
</head>
<body>

<p id="p1">
The getAllResponseHeaders() function returns the headers of a resource.
The headers contain file information like length,
server-type, content-type, date-modified, etc.
</p>

<button onclick="loadXMLDoc('4_ajaxTest_xml_greeting.aspx')">Get Headers</button>

</body>
</html>

